#!/usr/bin/env python3
"""
å…¨ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã«åŒ…æ‹¬çš„ãªæ—¥æœ¬èªèª¬æ˜ã‚’è¿½åŠ 
å„ã‚³ãƒ¼ãƒ‰ã‚»ãƒ«ã®å‰å¾Œã«è©³ç´°ãªè§£èª¬ã‚’æŒ¿å…¥
"""

import json
from pathlib import Path

def create_markdown_cell(content):
    """ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ã‚»ãƒ«ã‚’ä½œæˆ"""
    lines = content.strip().split('\n')
    # å„è¡Œã®æœ«å°¾ã«æ”¹è¡Œã‚’è¿½åŠ ï¼ˆæœ€å¾Œã®è¡Œä»¥å¤–ï¼‰
    formatted_lines = [line + '\n' for line in lines[:-1]] + [lines[-1]] if lines else []
    return {
        "cell_type": "markdown",
        "metadata": {},
        "source": formatted_lines
    }

def insert_explanations_into_notebook(nb_path):
    """ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã®å„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«èª¬æ˜ã‚’æŒ¿å…¥"""
    print(f"\nå‡¦ç†ä¸­: {nb_path.name}")

    with open(nb_path, 'r', encoding='utf-8') as f:
        nb = json.load(f)

    original_cell_count = len(nb['cells'])
    new_cells = []

    # ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã”ã¨ã«èª¬æ˜ã‚’è¿½åŠ ã™ã‚‹ãƒ­ã‚¸ãƒƒã‚¯
    for i, cell in enumerate(nb['cells']):
        new_cells.append(cell)

        # markdownã‚»ãƒ«ã§è¦‹å‡ºã—ã‚’æ¤œå‡ºã—ã€ãã®å¾Œã«èª¬æ˜ã‚’è¿½åŠ 
        if cell['cell_type'] == 'markdown' and cell.get('source'):
            source = ''.join(cell['source'])

            # ã‚»ã‚¯ã‚·ãƒ§ãƒ³æ¤œå‡ºã¨èª¬æ˜è¿½åŠ 
            if '## ' in source or '### ' in source:
                # æ¬¡ã®ã‚»ãƒ«ãŒã‚³ãƒ¼ãƒ‰ã‚»ãƒ«ã®å ´åˆã€ãã®å‰ã«èª¬æ˜ã‚’æŒ¿å…¥
                if i + 1 < len(nb['cells']) and nb['cells'][i + 1]['cell_type'] == 'code':
                    explanation = create_section_explanation(source)
                    if explanation:
                        new_cells.append(create_markdown_cell(explanation))

        # ã‚³ãƒ¼ãƒ‰ã‚»ãƒ«ã®å¾Œã«çµæœã®è§£èª¬ã‚’è¿½åŠ 
        elif cell['cell_type'] == 'code' and cell.get('source'):
            code = ''.join(cell['source'])
            result_explanation = create_result_explanation(code)
            if result_explanation:
                new_cells.append(create_markdown_cell(result_explanation))

    nb['cells'] = new_cells

    with open(nb_path, 'w', encoding='utf-8') as f:
        json.dump(nb, f, ensure_ascii=False, indent=1)

    print(f"  å®Œäº†: {original_cell_count} â†’ {len(new_cells)} ã‚»ãƒ«")

def create_section_explanation(section_title):
    """ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒˆãƒ«ã«åŸºã¥ã„ã¦èª¬æ˜ã‚’ç”Ÿæˆ"""
    title_lower = section_title.lower()

    # ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ã®èª¬æ˜ãƒãƒƒãƒ”ãƒ³ã‚°
    explanations = {
        'import': """
#### ğŸ“¦ å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®èª­ã¿è¾¼ã¿

ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã¯ã€åˆ†æã«å¿…è¦ãªPythonãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’èª­ã¿è¾¼ã¿ã¾ã™ã€‚

**ä¸»è¦ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®å½¹å‰²**ï¼š
- **NumPy**: æ•°å€¤è¨ˆç®—ã®åŸºç›¤ï¼ˆé…åˆ—æ“ä½œã€æ•°å­¦é–¢æ•°ï¼‰
- **Pandas**: ãƒ‡ãƒ¼ã‚¿æ“ä½œã¨åˆ†æï¼ˆè¡¨å½¢å¼ãƒ‡ãƒ¼ã‚¿ã®å‡¦ç†ï¼‰
- **Matplotlib / Seaborn**: ãƒ‡ãƒ¼ã‚¿å¯è¦–åŒ–ï¼ˆã‚°ãƒ©ãƒ•ä½œæˆï¼‰
- **scikit-learn**: æ©Ÿæ¢°å­¦ç¿’ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã¨ãƒ„ãƒ¼ãƒ«

ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆã¯ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®æœ€åˆã«ä¸€åº¦ã ã‘è¡Œã„ã¾ã™ã€‚
ã“ã‚Œã«ã‚ˆã‚Šã€ä»¥é™ã®ã‚³ãƒ¼ãƒ‰ã§ã“ã‚Œã‚‰ã®æ©Ÿèƒ½ã‚’ä½¿ç”¨ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚
""",
        'ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ': """
#### ğŸ² ãƒ‡ãƒ¼ã‚¿ã®ç”Ÿæˆã¨æº–å‚™

æ©Ÿæ¢°å­¦ç¿’ã§ã¯ã€ã¾ãšå­¦ç¿’ç”¨ã®ãƒ‡ãƒ¼ã‚¿ã‚’ç”¨æ„ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
ã“ã®ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã§ã¯ã€`scikit-learn`ã®ä¾¿åˆ©ãªé–¢æ•°ã‚’ä½¿ã£ã¦ã€
ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ã‚’ç”Ÿæˆã—ã¾ã™ã€‚

**ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ã†ç†ç”±**ï¼š
1. **å­¦ç¿’ç›®çš„**: å®Ÿéš›ã®ãƒ‡ãƒ¼ã‚¿åé›†ã¯æ™‚é–“ãŒã‹ã‹ã‚‹
2. **å®Ÿé¨“ã®å†ç¾æ€§**: åŒã˜ãƒ‡ãƒ¼ã‚¿ã§ä½•åº¦ã§ã‚‚å®Ÿé¨“ã§ãã‚‹
3. **æ­£è§£ãŒåˆ†ã‹ã£ã¦ã„ã‚‹**: ãƒ¢ãƒ‡ãƒ«ã®æ¤œè¨¼ãŒå®¹æ˜“
4. **æ§˜ã€…ãªãƒ‘ã‚¿ãƒ¼ãƒ³**: ç•°ãªã‚‹ç‰¹æ€§ã®ãƒ‡ãƒ¼ã‚¿ã§è©¦ã›ã‚‹

ç”Ÿæˆã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã®ç‰¹æ€§ï¼ˆã‚µãƒ³ãƒ—ãƒ«æ•°ã€ç‰¹å¾´é‡æ•°ã€ãƒã‚¤ã‚ºãªã©ï¼‰ã¯ã€
ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§è‡ªç”±ã«èª¿æ•´ã§ãã¾ã™ã€‚
""",
        'train_test_split': """
#### âœ‚ï¸ ãƒ‡ãƒ¼ã‚¿ã®åˆ†å‰²ï¼šè¨“ç·´ç”¨ã¨ãƒ†ã‚¹ãƒˆç”¨

æ©Ÿæ¢°å­¦ç¿’ã§ã¯ã€ãƒ‡ãƒ¼ã‚¿ã‚’**è¨“ç·´ãƒ‡ãƒ¼ã‚¿**ã¨**ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿**ã«åˆ†å‰²ã™ã‚‹ã®ãŒåŸºæœ¬ã§ã™ã€‚

**ãªãœåˆ†å‰²ã™ã‚‹ã®ã‹ï¼Ÿ**

å­¦æ ¡ã®ãƒ†ã‚¹ãƒˆã‚’æƒ³åƒã—ã¦ãã ã•ã„ï¼š
- ç·´ç¿’å•é¡Œï¼ˆè¨“ç·´ãƒ‡ãƒ¼ã‚¿ï¼‰ã§å‹‰å¼·ã™ã‚‹
- æœ¬ç•ªã®ãƒ†ã‚¹ãƒˆï¼ˆãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ï¼‰ã§å®ŸåŠ›ã‚’æ¸¬ã‚‹

åŒã˜å•é¡Œã‚’ä½•åº¦ã‚‚è§£ã„ã¦è¦šãˆã¦ã‚‚ã€æœ¬å½“ã®å®ŸåŠ›ã¯åˆ†ã‹ã‚Šã¾ã›ã‚“ã€‚
æ©Ÿæ¢°å­¦ç¿’ã‚‚åŒã˜ã§ã€å­¦ç¿’ã«ä½¿ã£ãŸãƒ‡ãƒ¼ã‚¿ã§è©•ä¾¡ã™ã‚‹ã¨ã€
æœ¬å½“ã®æ€§èƒ½ï¼ˆæ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ã¸ã®å¯¾å¿œåŠ›ï¼‰ãŒæ¸¬ã‚Œã¾ã›ã‚“ã€‚

**ä¸€èˆ¬çš„ãªåˆ†å‰²æ¯”ç‡**ï¼š
- è¨“ç·´ãƒ‡ãƒ¼ã‚¿: 70-80%
- ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿: 20-30%

ãƒ‡ãƒ¼ã‚¿é‡ãŒå¤šã„å ´åˆã¯ã€ã•ã‚‰ã«**æ¤œè¨¼ãƒ‡ãƒ¼ã‚¿**ã‚‚ç”¨æ„ã™ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚
""",
        'ãƒ¢ãƒ‡ãƒ«': """
#### ğŸ¤– ãƒ¢ãƒ‡ãƒ«ã®é¸æŠã¨åˆæœŸåŒ–

æ©Ÿæ¢°å­¦ç¿’ãƒ¢ãƒ‡ãƒ«ã¯ã€ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å­¦ç¿’ã™ã‚‹ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã§ã™ã€‚
å•é¡Œã®ç¨®é¡ã«å¿œã˜ã¦ã€é©åˆ‡ãªãƒ¢ãƒ‡ãƒ«ã‚’é¸æŠã—ã¾ã™ã€‚

**ãƒ¢ãƒ‡ãƒ«é¸æŠã®è€ƒãˆæ–¹**ï¼š

1. **å•é¡Œã®ç¨®é¡**ï¼š
   - åˆ†é¡ï¼ˆã‚«ãƒ†ã‚´ãƒªãƒ¼äºˆæ¸¬ï¼‰â†’ åˆ†é¡å™¨
   - å›å¸°ï¼ˆæ•°å€¤äºˆæ¸¬ï¼‰â†’ å›å¸°å™¨

2. **ãƒ‡ãƒ¼ã‚¿ã®ç‰¹æ€§**ï¼š
   - ç·šå½¢ã«åˆ†é›¢å¯èƒ½ â†’ ç·šå½¢ãƒ¢ãƒ‡ãƒ«
   - éç·šå½¢é–¢ä¿‚ â†’ æœ¨ãƒ¢ãƒ‡ãƒ«ã€ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯

3. **ãƒ‡ãƒ¼ã‚¿é‡**ï¼š
   - å°‘é‡ â†’ ã‚·ãƒ³ãƒ—ãƒ«ãªãƒ¢ãƒ‡ãƒ«
   - å¤§é‡ â†’ è¤‡é›‘ãªãƒ¢ãƒ‡ãƒ«ã‚‚ä½¿ãˆã‚‹

4. **è§£é‡ˆæ€§ã®å¿…è¦æ€§**ï¼š
   - å¿…è¦ â†’ ç·šå½¢ãƒ¢ãƒ‡ãƒ«ã€æ±ºå®šæœ¨
   - ä¸è¦ â†’ ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯

5. **è¨ˆç®—è³‡æº**ï¼š
   - é™ã‚‰ã‚Œã¦ã„ã‚‹ â†’ è»½é‡ãªãƒ¢ãƒ‡ãƒ«
   - ååˆ†ã«ã‚ã‚‹ â†’ è¤‡é›‘ãªãƒ¢ãƒ‡ãƒ«ã‚‚å¯

**ã¾ãšã¯ã‚·ãƒ³ãƒ—ãƒ«ãªãƒ¢ãƒ‡ãƒ«ã‹ã‚‰è©¦ã™**ã®ãŒé‰„å‰‡ã§ã™ã€‚
""",
        'å­¦ç¿’': """
#### ğŸ“š ãƒ¢ãƒ‡ãƒ«ã®å­¦ç¿’ï¼ˆè¨“ç·´ï¼‰

`.fit()`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã¶ã“ã¨ã§ã€ãƒ¢ãƒ‡ãƒ«ãŒãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å­¦ç¿’ã—ã¾ã™ã€‚

**å­¦ç¿’ãƒ—ãƒ­ã‚»ã‚¹ã§èµ·ã“ã‚‹ã“ã¨**ï¼š

1. **ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®åˆæœŸåŒ–**ï¼š
   - ãƒ¢ãƒ‡ãƒ«å†…éƒ¨ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«è¨­å®š

2. **ãƒ‘ã‚¿ãƒ¼ãƒ³ã®æ¢ç´¢**ï¼š
   - è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã‚’ç¹°ã‚Šè¿”ã—åˆ†æ
   - ç‰¹å¾´é‡ã¨ãƒ©ãƒ™ãƒ«ã®é–¢ä¿‚ã‚’æ¢ã™

3. **æœ€é©åŒ–**ï¼š
   - äºˆæ¸¬èª¤å·®ã‚’æœ€å°åŒ–ã™ã‚‹ã‚ˆã†ã«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’èª¿æ•´
   - å‹¾é…é™ä¸‹æ³•ãªã©ã®æœ€é©åŒ–ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’ä½¿ç”¨

4. **åæŸåˆ¤å®š**ï¼š
   - èª¤å·®ãŒååˆ†å°ã•ããªã£ãŸã‚‰çµ‚äº†
   - ã¾ãŸã¯ã€æœ€å¤§ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ•°ã«é”ã—ãŸã‚‰çµ‚äº†

**å­¦ç¿’æ™‚é–“**ï¼š
- ãƒ‡ãƒ¼ã‚¿é‡ã€ç‰¹å¾´é‡æ•°ã€ãƒ¢ãƒ‡ãƒ«ã®è¤‡é›‘ã•ã«ä¾å­˜
- æ•°ç§’ã€œæ•°æ™‚é–“ã¾ã§æ§˜ã€…

å­¦ç¿’ãŒå®Œäº†ã™ã‚‹ã¨ã€ãƒ¢ãƒ‡ãƒ«ã¯æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ã«å¯¾ã—ã¦äºˆæ¸¬ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚
""",
        'äºˆæ¸¬': """
#### ğŸ¯ äºˆæ¸¬ã®å®Ÿè¡Œ

å­¦ç¿’ã—ãŸãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ã£ã¦ã€æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ã®çµæœã‚’äºˆæ¸¬ã—ã¾ã™ã€‚

**äºˆæ¸¬ã®æµã‚Œ**ï¼š

1. **å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã®æº–å‚™**ï¼š
   - ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ï¼ˆãƒ¢ãƒ‡ãƒ«ãŒæœªçŸ¥ã®ãƒ‡ãƒ¼ã‚¿ï¼‰ã‚’ç”¨æ„
   - è¨“ç·´æ™‚ã¨åŒã˜å½¢å¼ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚‹

2. **ãƒ¢ãƒ‡ãƒ«ã®é©ç”¨**ï¼š
   - `.predict()`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã¶
   - ãƒ¢ãƒ‡ãƒ«ãŒå­¦ç¿’ã—ãŸãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’é©ç”¨

3. **çµæœã®å–å¾—**ï¼š
   - åˆ†é¡: ã‚¯ãƒ©ã‚¹ãƒ©ãƒ™ãƒ«ï¼ˆ0, 1, 2ãªã©ï¼‰
   - å›å¸°: æ•°å€¤ï¼ˆä¾¡æ ¼ã€ã‚¹ã‚³ã‚¢ãªã©ï¼‰

**ç¢ºç‡ã®å–å¾—**ï¼ˆåˆ†é¡ã®å ´åˆï¼‰ï¼š
```python
# ã‚¯ãƒ©ã‚¹ã®äºˆæ¸¬
y_pred = model.predict(X_test)

# äºˆæ¸¬ç¢ºç‡ã®å–å¾—
y_proba = model.predict_proba(X_test)
# ä¾‹: [[0.1, 0.9], [0.8, 0.2], ...]
# å„è¡ŒãŒ1ã¤ã®ã‚µãƒ³ãƒ—ãƒ«ã®ç¢ºç‡åˆ†å¸ƒ
```

äºˆæ¸¬ç¢ºç‡ã¯ã€ãƒ¢ãƒ‡ãƒ«ã®ç¢ºä¿¡åº¦ã‚’çŸ¥ã‚ŠãŸã„å ´åˆã«ä¾¿åˆ©ã§ã™ã€‚
""",
        'è©•ä¾¡': """
#### ğŸ“Š ãƒ¢ãƒ‡ãƒ«ã®æ€§èƒ½è©•ä¾¡

ãƒ¢ãƒ‡ãƒ«ãŒå®Ÿéš›ã«ã©ã‚Œã ã‘æ­£ç¢ºã«äºˆæ¸¬ã§ãã‚‹ã‹ã‚’æ¸¬å®šã—ã¾ã™ã€‚

**è©•ä¾¡æŒ‡æ¨™ã®é¸æŠ**ï¼š

**åˆ†é¡å•é¡Œ**ï¼š
- **æ­£è§£ç‡ï¼ˆAccuracyï¼‰**: å…¨ä½“ã®æ­£è§£ç‡
- **é©åˆç‡ï¼ˆPrecisionï¼‰**: é™½æ€§äºˆæ¸¬ã®æ­£ç¢ºã•
- **å†ç¾ç‡ï¼ˆRecallï¼‰**: å®Ÿéš›ã®é™½æ€§ã®æ¤œå‡ºç‡
- **F1ã‚¹ã‚³ã‚¢**: é©åˆç‡ã¨å†ç¾ç‡ã®ãƒãƒ©ãƒ³ã‚¹

**å›å¸°å•é¡Œ**ï¼š
- **å¹³å‡äºŒä¹—èª¤å·®ï¼ˆMSEï¼‰**: äºˆæ¸¬èª¤å·®ã®å¹³å‡
- **å¹³å‡çµ¶å¯¾èª¤å·®ï¼ˆMAEï¼‰**: çµ¶å¯¾èª¤å·®ã®å¹³å‡
- **æ±ºå®šä¿‚æ•°ï¼ˆRÂ²ï¼‰**: ãƒ¢ãƒ‡ãƒ«ã®èª¬æ˜åŠ›

**è©•ä¾¡ã®é‡è¦æ€§**ï¼š

1. **ãƒ¢ãƒ‡ãƒ«ã®é¸æŠ**: ã©ã®ãƒ¢ãƒ‡ãƒ«ãŒæœ€é©ã‹åˆ¤æ–­
2. **ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿èª¿æ•´**: ã‚ˆã‚Šè‰¯ã„è¨­å®šã‚’æ¢ã™
3. **æœ¬ç•ªæŠ•å…¥ã®åˆ¤æ–­**: å®Ÿç”¨ã«è€ãˆã‚‹ã‹ç¢ºèª

**æ³¨æ„ç‚¹**ï¼š
- è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã§è©•ä¾¡ã—ã¦ã¯ã„ã‘ãªã„
- ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã¯1å›ã ã‘ä½¿ã†ï¼ˆä½•åº¦ã‚‚ä½¿ã†ã¨éå­¦ç¿’ï¼‰
- è¤‡æ•°ã®æŒ‡æ¨™ã§ç·åˆçš„ã«åˆ¤æ–­ã™ã‚‹
""",
    }

    for keyword, explanation in explanations.items():
        if keyword.lower() in title_lower:
            return explanation

    return None

def create_result_explanation(code):
    """ã‚³ãƒ¼ãƒ‰ã«åŸºã¥ã„ã¦çµæœã®è§£èª¬ã‚’ç”Ÿæˆ"""
    code_lower = code.lower()

    # ç‰¹å®šã®ã‚³ãƒ¼ãƒ‰ãƒ‘ã‚¿ãƒ¼ãƒ³ã«å¯¾ã™ã‚‹è§£èª¬
    if 'make_classification' in code_lower:
        return """
**ç”Ÿæˆã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã®ç‰¹å¾´**ï¼š
- å„ã‚µãƒ³ãƒ—ãƒ«ã¯è¤‡æ•°ã®ç‰¹å¾´é‡ã‚’æŒã¤
- å„ã‚µãƒ³ãƒ—ãƒ«ã«ã¯æ­£è§£ãƒ©ãƒ™ãƒ«ï¼ˆã‚¯ãƒ©ã‚¹ï¼‰ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ã‚‹
- ç‰¹å¾´é‡ã¯æ­£è¦åŒ–ã•ã‚Œã¦ã„ãªã„ç”Ÿã®å€¤

ã“ã®ãƒ‡ãƒ¼ã‚¿ã‚’å¯è¦–åŒ–ã™ã‚‹ã¨ã€ã‚¯ãƒ©ã‚¹é–“ã®åˆ†é›¢åº¦ãŒç¢ºèªã§ãã¾ã™ã€‚
åˆ†é›¢ãŒæ˜ç¢ºãªã»ã©ã€ãƒ¢ãƒ‡ãƒ«ã®å­¦ç¿’ã¯å®¹æ˜“ã«ãªã‚Šã¾ã™ã€‚
"""
    elif 'train_test_split' in code_lower:
        return """
**åˆ†å‰²å¾Œã®ãƒ‡ãƒ¼ã‚¿**ï¼š
- `X_train`, `y_train`: ãƒ¢ãƒ‡ãƒ«ã®å­¦ç¿’ã«ä½¿ç”¨
- `X_test`, `y_test`: ãƒ¢ãƒ‡ãƒ«ã®è©•ä¾¡ã«ä½¿ç”¨

`random_state`ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è¨­å®šã™ã‚‹ã“ã¨ã§ã€
å®Ÿé¨“ã®å†ç¾æ€§ã‚’ç¢ºä¿ã§ãã¾ã™ï¼ˆæ¯å›åŒã˜åˆ†å‰²çµæœï¼‰ã€‚
"""
    elif '.fit(' in code_lower and 'model' in code_lower:
        return """
**å­¦ç¿’å®Œäº†å¾Œ**ï¼š
- ãƒ¢ãƒ‡ãƒ«ã¯è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’è¨˜æ†¶ã—ã¦ã„ã¾ã™
- æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ã«å¯¾ã—ã¦äºˆæ¸¬ã§ãã‚‹çŠ¶æ…‹ã«ãªã‚Šã¾ã—ãŸ
- ãƒ¢ãƒ‡ãƒ«å†…éƒ¨ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒæœ€é©åŒ–ã•ã‚Œã¦ã„ã¾ã™

æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã¯ã€ã“ã®ãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ã£ã¦ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã§äºˆæ¸¬ã‚’è¡Œã„ã€
æ€§èƒ½ã‚’è©•ä¾¡ã™ã‚‹ã“ã¨ã§ã™ã€‚
"""
    elif '.predict(' in code_lower:
        return """
**äºˆæ¸¬çµæœã®ä½¿ã„æ–¹**ï¼š
- äºˆæ¸¬å€¤ã¨å®Ÿéš›ã®å€¤ã‚’æ¯”è¼ƒã—ã¦ç²¾åº¦ã‚’è©•ä¾¡
- èª¤ã£ãŸäºˆæ¸¬ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’åˆ†æ
- äºˆæ¸¬ç¢ºç‡ã‚’è¦‹ã¦ã€ãƒ¢ãƒ‡ãƒ«ã®ç¢ºä¿¡åº¦ã‚’ç¢ºèª

äºˆæ¸¬ãŒå®Œç’§ã§ãªã„ã®ã¯æ­£å¸¸ã§ã™ã€‚é‡è¦ãªã®ã¯ã€
å®Ÿç”¨ã«è€ãˆã‚‹ç²¾åº¦ã‹ã©ã†ã‹ã‚’åˆ¤æ–­ã™ã‚‹ã“ã¨ã§ã™ã€‚
"""
    elif 'score' in code_lower or 'accuracy' in code_lower:
        return """
**ã‚¹ã‚³ã‚¢ã®è§£é‡ˆ**ï¼š
- 1.0ã«è¿‘ã„ã»ã©é«˜ç²¾åº¦
- å•é¡Œã®é›£æ˜“åº¦ã«ã‚ˆã£ã¦ã€Œè‰¯ã„ã‚¹ã‚³ã‚¢ã€ã®åŸºæº–ã¯ç•°ãªã‚‹
- ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ï¼ˆãƒ©ãƒ³ãƒ€ãƒ äºˆæ¸¬ã‚„ã‚·ãƒ³ãƒ—ãƒ«ãªãƒ«ãƒ¼ãƒ«ï¼‰ã¨æ¯”è¼ƒã™ã‚‹ã“ã¨ãŒé‡è¦

**æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—**ï¼š
- ã‚¹ã‚³ã‚¢ãŒä½ã„å ´åˆ: ç‰¹å¾´é‡ã®è¿½åŠ ã€ãƒ¢ãƒ‡ãƒ«ã®å¤‰æ›´ã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿èª¿æ•´
- ã‚¹ã‚³ã‚¢ãŒé«˜ã™ãã‚‹å ´åˆ: éå­¦ç¿’ã®å¯èƒ½æ€§ã‚’ç–‘ã†
- ãƒãƒ©ãƒ³ã‚¹ãŒè‰¯ã„å ´åˆ: ä»–ã®è©•ä¾¡æŒ‡æ¨™ã‚‚ç¢ºèª
"""
    elif 'confusion_matrix' in code_lower:
        return """
**æ··åŒè¡Œåˆ—ã®èª­ã¿æ–¹**ï¼š
- å¯¾è§’ç·šä¸Šã®å€¤ãŒå¤§ãã„ã»ã©è‰¯ã„ï¼ˆæ­£ã—ã„äºˆæ¸¬ï¼‰
- å¯¾è§’ç·šå¤–ã®å€¤ã¯èª¤äºˆæ¸¬
- ã©ã®ã‚¯ãƒ©ã‚¹ã®èª¤äºˆæ¸¬ãŒå¤šã„ã‹åˆ†æã§ãã‚‹

æ··åŒè¡Œåˆ—ã‹ã‚‰ã€ãƒ¢ãƒ‡ãƒ«ã®å¼·ã¿ã¨å¼±ã¿ãŒè¦‹ãˆã¦ãã¾ã™ã€‚
ç‰¹å®šã®ã‚¯ãƒ©ã‚¹ã®äºˆæ¸¬ç²¾åº¦ãŒä½ã„å ´åˆã€ãã®ã‚¯ãƒ©ã‚¹ã®ã‚µãƒ³ãƒ—ãƒ«ã‚’
å¢—ã‚„ã™ãªã©ã®å¯¾ç­–ãŒè€ƒãˆã‚‰ã‚Œã¾ã™ã€‚
"""
    elif 'plt.' in code_lower or 'plot' in code_lower or 'sns.' in code_lower:
        return """
**å¯è¦–åŒ–ã®é‡è¦æ€§**ï¼š
ãƒ‡ãƒ¼ã‚¿ã‚„çµæœã‚’ã‚°ãƒ©ãƒ•ã§è¡¨ç¤ºã™ã‚‹ã¨ã€ä»¥ä¸‹ã®ã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã™ï¼š
- ãƒ‡ãƒ¼ã‚¿ã®åˆ†å¸ƒã‚„å‚¾å‘
- ã‚¯ãƒ©ã‚¹é–“ã®åˆ†é›¢åº¦
- å¤–ã‚Œå€¤ã®å­˜åœ¨
- ãƒ¢ãƒ‡ãƒ«ã®æ±ºå®šå¢ƒç•Œ

ã€Œç™¾èã¯ä¸€è¦‹ã«ã—ã‹ãšã€ã§ã™ã€‚è¤‡é›‘ãªãƒ‡ãƒ¼ã‚¿ã‚‚ã€
ã‚°ãƒ©ãƒ•ã«ã™ã‚Œã°ä¸€ç›®ã§ç‰¹å¾´ã‚’ç†è§£ã§ãã¾ã™ã€‚
"""

    return None

def main():
    """ãƒ¡ã‚¤ãƒ³å‡¦ç†"""
    print("=" * 70)
    print("ğŸ“š å…¨ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã«åŒ…æ‹¬çš„ãªèª¬æ˜ã‚’è¿½åŠ ")
    print("=" * 70)

    notebooks_dir = Path("/home/user/machine-learning-playground/notebooks")
    notebooks = sorted(notebooks_dir.glob("*_improved_v2.ipynb"))

    for nb_path in notebooks:
        insert_explanations_into_notebook(nb_path)

    print("\n" + "=" * 70)
    print(f"âœ… å®Œäº†ï¼{len(notebooks)}å€‹ã®ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã‚’æ‹¡å¼µã—ã¾ã—ãŸ")
    print("=" * 70)

if __name__ == "__main__":
    main()
